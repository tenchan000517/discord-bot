# EC2インスタンスへの接続とMongoDBデータ確認手順書

## 1. 必要な情報の確認
以下の情報を事前に用意してください：
- EC2インスタンスのIPアドレス（例：18.181.82.180）
- .pemファイルの場所（例：C:\discord-gacha-bot\discord-bot-key.pem）
- MongoDBの認証情報
  - ユーザー名：adminUser
  - パスワード：tenchan1341

## 2. VS Codeの起動と設定
1. VS Codeを起動
2. ターミナルを開く
   - 方法1：上部メニューの「表示(View)」→「ターミナル(Terminal)」をクリック
   - 方法2：キーボードショートカット「Ctrl + @」を使用

## 3. EC2インスタンスへの接続
1. VS Codeのターミナルで以下のコマンドを実行：
```bash
ssh -i "C:\discord-gacha-bot\discord-bot-key.pem" ec2-user@18.181.82.180
```

2. 初回接続時は以下のような警告が表示されます：
```
The authenticity of host '18.181.82.180 (18.181.82.180)' can't be established.
XXXXXXXXX key fingerprint is XXXXXXXXXXXXXXXXXXXXXXXXXXXXXX.
Are you sure you want to continue connecting (yes/no/[fingerprint])?
```
- この場合は「yes」と入力してEnterを押します

3. 接続成功の確認
- プロンプトが以下のように変わっていれば接続成功：
```
[ec2-user@ip-172-31-xxx-xxx ~]$
```

## 4. MongoDBサービスの確認
1. MongoDBの状態確認：
```bash
sudo systemctl status mongod
```

2. もし実行されていない場合は起動：
```bash
sudo systemctl start mongod
```

## 5. MongoDBへの接続とデータ確認
1. MongoDB Shellへの接続：
```bash
mongosh --authenticationDatabase "admin" -u "adminUser" -p "tenchan1341"
```

2. データベースへの切り替え：
```javascript
use discord_bot
```

3. データの確認：
```javascript
// サーバー設定の確認
db.server_settings.find()

// ユーザーデータの確認
db.users.find()

// ガチャ履歴の確認
db.gacha_history.find()
```

## 6. 終了手順
1. MongoDB Shellの終了：
```javascript
exit
```

2. EC2インスタンスからの切断：
```bash
exit
```

## トラブルシューティング

### SSH接続エラーの場合
- .pemファイルのパスが正しいか確認
- IPアドレスが正しいか確認
- .pemファイルのパーミッションを確認

### MongoDB接続エラーの場合
- MongoDBサービスが実行中か確認
- 認証情報（ユーザー名・パスワード）が正しいか確認

## 注意事項
- パスワードは環境に応じて適切に変更してください
- IPアドレスは環境に応じて変更してください
- .pemファイルは安全な場所に保管し、外部に共有しないでください